<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Shuttle Bus Tracker</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <link rel="stylesheet" href="css/styles.css">

</head>

<body>
  <nav class="navbar navbar-expand-lg" data-bs-theme="dark">
    <div class="container">
      <a class="navbar-brand" href="#">MEDIAPOLIS<sup class="app-status">BETA</sup></a>
      <button class="navbar-toggler border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navbarToggler" aria-controls="navbarToggler" aria-expanded="false" aria-label="Toggle navigation">
        <i class="bi bi-list"></i>
      </button>
      <div class="collapse navbar-collapse" id="navbarToggler">
        <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="index.html">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="about.html">About</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="faq.html">FAQ</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="help.html">Help</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- 行車狀態顯示條 與 動態問候訊息 -->
  <header>
    <div class="container py-4">
      <div class="row">
        <div class="col-12">
          <div class="status-panel mb-4 p-3">
            <div class="status-indicator status-on"></div>
            <span class="fw-bold">ON SERVICE</span>
          </div>

          <div class="text-center">
            <h4 class="greeting mb-2">Good Evening, Off-Duty Hero!</h4>
            <h4 class="message mb-2">Don't be blue, is Monday</h4>
            <h5 class="look-where mb-0">Look where I am now...</h5>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- 主要動態時間表 -->
  <div class="container main-timetable py-4"></div>

  <!-- 注意事項 -->
  <div class="container py-4">
    <div class="row justify-content-center">
      
      <!-- 這是分割線 -->
      <div class="w-75 horizontal-divider mb-4"></div>

      <div class="col-12 text-center">
        <div class="title-panel attention mb-2">
          <i class="bi bi-exclamation-triangle"></i>
          <span class="fw-bold"> ATTENTION</span>
        </div>
      </div>
      <div class="col-11">
        <div class="row justify-content-center align-items-center">
          <div class="col-4 col-md-2">
            <img src="imgs/img_free_ride.png" alt="No Ticket Needed" class="img-fluid">
          </div>
          <div class="col-8 col-md-4">
            <p class="mb-0 fw-bold">BUS SERVICE IS FREE TO ALL CAMPUS EMPLOYEES</p>
          </div>
    
          <div class="w-100"></div>
    
          <div class="col-4 col-md-2">
            <img src="imgs/img_signboard.png" alt="Look for Signboard" class="img-fluid">
          </div>
          <div class="col-8 col-md-4">
            <p class="mb-0 fw-bold">LOOK OUT FOR CAMPUS LOGO
              DISPLAYED ON BUS</p>
          </div>
    
          <div class="w-100"></div>
    
          <div class="col-4 col-md-2">
            <img src="imgs/img_badge.png" alt="ID Badge Required" class="img-fluid">
          </div>
          <div class="col-8 col-md-4">
            <p class="mb-0 fw-bold">KINDLY DISPLAY STAFF PASS
              BEFORE BOARDING</p>
          </div>
    
          <div class="w-100"></div>
    
          <div class="col-4 col-md-2">
            <img src="imgs/img_no_guest_allow.png" alt="Staff Only" class="img-fluid">
          </div>
          <div class="col-8 col-md-4">
            <p class="mb-0 fw-bold">NO GUEST ALLOW<br>
              <span class="require-attention">*</span>CAMPUS STAFF ONLY
            </p>
          </div>
        </div>
      </div>
    
      <!-- 這是分割線 -->
      <div class="w-75 horizontal-divider pt-4 mb-4"></div>
    
      <div class="col-10">
        <div class="row justify-content-center">
          <div class="col-4 col-md-2 pb-4">
            <img src="imgs/img_no_pet.png" alt="No Pet" class="img-fluid">
          </div>
          <div class="col-4 col-md-2 pb-4">
            <img src="imgs/img_no_guest.png" alt="No Guest" class="img-fluid">
          </div>
          <div class="col-4 col-md-2 pb-4">
            <img src="imgs/img_no_standing.png" alt="No Staning" class="img-fluid">
          </div>
          <div class="col-4 col-md-2 pb-4">
            <img src="imgs/img_no_smoking.png" alt="No Smoking" class="img-fluid">
          </div>
          <div class="col-4 col-md-2 pb-4">
            <img src="imgs/img_no_food.png" alt="No Food" class="img-fluid">
          </div>
          <div class="col-4 col-md-2 pb-4">
            <img src="imgs/img_no_durian.png" alt="No Durian" class="img-fluid">
          </div>
        </div>
      </div>
    </div>
  </div>

  <footer class="bg-footer">
    <div class="container py-4">
      <div class="row">
        <div class="col-12 text-center">
          <img src="imgs/img_shuttle_bee.png" alt="" class="img-bee">
          <p class="mb-0">Shuttle Bee is working hard to your destination…</p>
        </div>
      </div>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script src="js/routes.js"></script>

  <script>
    const greetingsConfig = {
      greetings: {
        MORNING: "Good Morning, Mate!",
        LUNCH: "Good Afternoon, Eater!",
        EVENING: "Good Evening, Off-Duty Hero!",
        WEEKEND: "Sorry! Off Service today!"
      },
      dailyMessages: {
        Monday: [
          "Monday? Let's make it a fun day!",
          "New week, new goals. Let's go!",
          "Monday blues? Nah, we got this!",
          "Wake up. Kick ass. Repeat. It's Monday!",
          "Hello, Monday. Be gentle, please."
        ],
        Tuesday: [
          "Keep the momentum, it's Tuesday!",
          "Tuesday: One step closer to Friday!",
          "You survived Monday. You got this!",
          "Tuesdays are for making progress!",
          "Stay strong, Tuesday won't last forever!"
        ],
        Wednesday: [
          "Halfway there! Happy Wednesday!",
          "It's Wednesday, keep pushing!",
          "The weekend is in sight!",
          "Work hard, Wednesday harder!",
          "Wednesdays are for warriors!"
        ],
        Thursday: [
          "Thursday vibes: Almost there!",
          "Push through, the weekend is calling!",
          "One more day to go, stay strong!",
          "Thirsty for Friday? Hold on!",
          "Thursday: The weekend's warm-up!"
        ],
        Friday: [
          "Finally Friday! Let's rock!",
          "It's Fri-YAY! Let the fun begin!",
          "Work hard, party harder. Happy Friday!",
          "Weekend mode: ON!",
          "Cheers to the weekend!"
        ]
      }
    };

    const serviceConfig = {
      manualOverride: {
        enabled: false,
        status: "SERVICE_UNKNOWN"
      },
      operatingHours: [
        {
          days: ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"],
          periods: [
            { start: "07:30", end: "10:00" },
            { start: "11:30", end: "14:00" },
            { start: "17:00", end: "19:30" }
          ]
        }
      ]
    };

    function updateGreeting() {
      const now = new Date();
      const hour = now.getHours();
      const currentDay = now.toLocaleDateString('en-US', { weekday: 'long' });

      let periodGreeting;
      if (currentDay === "Saturday" || currentDay === "Sunday") {
        periodGreeting = greetingsConfig.greetings.WEEKEND;
      } else if (hour >= 5 && hour < 12) {
        periodGreeting = greetingsConfig.greetings.MORNING;
      } else if (hour >= 12 && hour < 17) {
        periodGreeting = greetingsConfig.greetings.LUNCH;
      } else {
        periodGreeting = greetingsConfig.greetings.EVENING;
      }

      const dailyMessages = greetingsConfig.dailyMessages[currentDay];
      const randomMessage = dailyMessages ? dailyMessages[Math.floor(Math.random() * dailyMessages.length)] : "";

      const greetingElement = document.querySelector('.greeting');
      const messageElement = document.querySelector('.message');
      const lookWhereElement = document.querySelector('.look-where');

      if (greetingElement) {
        greetingElement.textContent = periodGreeting;
      } else {
        console.error('Greeting element not found');
      }

      if (messageElement && lookWhereElement) {
        if (currentDay === "Saturday" || currentDay === "Sunday") {
          messageElement.style.display = 'none';
          lookWhereElement.style.display = 'none';
        } else {
          messageElement.style.display = 'block';
          lookWhereElement.style.display = 'block';
          messageElement.textContent = randomMessage;
        }
      } else {
        console.error('Message or look-where element not found');
      }
    }

    function updateServiceStatus() {
      const now = new Date();
      const currentDay = now.toLocaleDateString('en-US', { weekday: 'long' });
      const currentTime = now.toLocaleTimeString('en-US', {
        hour: '2-digit',
        minute: '2-digit',
        hour12: false
      });

      if (serviceConfig.manualOverride.enabled) {
        setStatus(serviceConfig.manualOverride.status);
        return;
      }

      const isOperatingDay = serviceConfig.operatingHours[0].days.includes(currentDay);
      if (!isOperatingDay) {
        setStatus("OFF_SERVICE");
        return;
      }

      const isServiceTime = serviceConfig.operatingHours[0].periods.some(period => {
        return currentTime >= period.start && currentTime <= period.end;
      });

      setStatus(isServiceTime ? "ON_SERVICE" : "OFF_SERVICE");
    }

    function setStatus(status) {
      const statusIndicator = document.querySelector('.status-indicator');
      const statusText = document.querySelector('.status-indicator + span');

      if (statusIndicator && statusText) {
        statusIndicator.className = 'status-indicator';
        switch (status) {
          case "ON_SERVICE":
            statusIndicator.classList.add('status-on');
            statusText.textContent = "ON SERVICE";
            break;
          case "OFF_SERVICE":
            statusIndicator.classList.add('status-off');
            statusText.textContent = "OFF SERVICE";
            break;
          case "SERVICE_UNKNOWN":
            statusIndicator.classList.add('status-unknown');
            statusText.textContent = "SERVICE UNKNOWN";
            break;
        }
      } else {
        console.error('Status elements not found');
      }
    }

    // Initialize
    updateServiceStatus();
    updateGreeting();

    // 更新間隔改為每秒
    setInterval(updateServiceStatus, 60000); // 1分鐘
    setInterval(updateGreeting, 60000); // 1分鐘
    setInterval(() => routeHandler.updateInterface(), 5000); // 5秒

    // For testing manual override
    window.toggleManualOverride = function (enabled, status) {
      serviceConfig.manualOverride.enabled = enabled;
      if (status) serviceConfig.manualOverride.status = status;
      updateServiceStatus();
    }
  </script>

  <!-- Time Simulator -->
  <!-- <script src="js/timeSimulator.js"></script> -->
</body>

</html>