<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Shuttle Bus Tracker</title>

  <!-- PWA Meta Tags -->
  <meta name="theme-color" content="#000000">
  <meta name="description" content="Mediapolis Shuttle Bus Tracking Web App">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="Shuttle Bus">
  
  <!-- PWA Icons -->
  <link rel="manifest" href="manifest.json">
  <link rel="icon" type="image/png" sizes="192x192" href="icons/icon-192x192.png">
  <link rel="apple-touch-icon" href="icons/icon-192x192.png">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <link rel="stylesheet" href="css/styles.css">
</head>

<body>
  <nav class="navbar" data-bs-theme="dark">
    <div class="container">
      <a class="navbar-brand" href="#">MEDIAPOLIS<sup class="app-status">BETA</sup></a>
    </div>
  </nav>

  <ul class="nav justify-content-center fixed-bottom py-2">
    <li class="nav-item">
      <a class="nav-link active" aria-current="page" href="index.html"><i class="bi bi-house-door-fill"></i><br><span>Home</span></a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="about.html"><i class="bi bi-bus-front-fill"></i><br><span>About</span></a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="index.html"><div class="highlight-btn"><i class="bi bi-arrow-repeat"></i></div>Recheck</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="faq.html"><i class="bi bi-ui-checks"></i><br><span>FAQ</span></a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="help.html"><i class="bi bi-question-circle"></i><br><span>Help</span></a>
    </li>
  </ul>

  <!-- 行車狀態顯示條 與 動態問候訊息 -->
  <header>
    <div class="container py-4">
      <div class="row">
        <div class="col-12">
          
          <!-- Current Date Display -->
          <div class="current-date-container mb-2">
            <div class="d-flex justify-content-between align-items-center">
              <div class="status-wrapper">
                <div class="status-panel">
                  <div id="statusIndicator" class="status-indicator"></div>
                  <span class="" id="currentTimeRoute">-</span>
                </div>
              </div>
              <div class="text-end">
                <span class="fw-bold" id="currentDate">Loading Date and Time...</span>
                (<span class="fw-bold text-secondary" id="currentDayOfWeek"></span>)
                <br>
                <span id="currentTime" class="text-secondary current-date-time"></span>
              </div>
            </div>
          </div>

          <div class="text-center">
            <h6 class="greeting mb-0">Good Evening, Off-Duty Hero!</h6>
            <h6 class="message mb-0">Don't be blue, is Monday</h6>
            <h6 class="look-where mb-0">Look where I am now...</h6>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- 主要動態時間表 -->
  <!-- <div class="container main-timetable py-4"></div> -->
  <div class="container py-4">
    
    <!-- Time Selector Buttons -->
    <div class="time-selector" id="timeSelector">
      <!-- Dynamically generated time period buttons will be inserted here -->
    </div>
    
    <!-- Timetable Container -->
    <div id="timetableContainer">
      <div class="text-center py-5">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
        <p class="mt-2">Loading...</p>
      </div>
    </div>
  </div>

  <!-- 注意事項 -->
  <div class="container pb-4">
    <div class="row justify-content-center">
      
      <!-- 這是分割線 -->
      <div class="w-75 horizontal-divider mb-4"></div>

      <div class="col-12 text-center">
        <div class="title-panel attention mb-2">
          <i class="bi bi-exclamation-triangle"></i>
          <span class="fw-bold"> ATTENTION</span>
        </div>
      </div>
      <div class="col-11">
        <div class="row justify-content-center align-items-center">
          <div class="col-4 col-md-2">
            <img src="imgs/img_free_ride.png" alt="No Ticket Needed" class="img-fluid">
          </div>
          <div class="col-8 col-md-4">
            <p class="mb-0 fw-bold">BUS SERVICE IS FREE TO ALL CAMPUS EMPLOYEES</p>
          </div>
    
          <div class="w-100"></div>
    
          <div class="col-4 col-md-2">
            <img src="imgs/img_signboard.png" alt="Look for Signboard" class="img-fluid">
          </div>
          <div class="col-8 col-md-4">
            <p class="mb-0 fw-bold">LOOK OUT FOR CAMPUS LOGO
              DISPLAYED ON BUS</p>
          </div>
    
          <div class="w-100"></div>
    
          <div class="col-4 col-md-2">
            <img src="imgs/img_badge.png" alt="ID Badge Required" class="img-fluid">
          </div>
          <div class="col-8 col-md-4">
            <p class="mb-0 fw-bold">KINDLY DISPLAY STAFF PASS
              BEFORE BOARDING</p>
          </div>
    
          <div class="w-100"></div>
    
          <div class="col-4 col-md-2">
            <img src="imgs/img_no_guest_allow.png" alt="Staff Only" class="img-fluid">
          </div>
          <div class="col-8 col-md-4">
            <p class="mb-0 fw-bold">NO GUEST ALLOW<br>
              <span class="require-attention">*</span>CAMPUS STAFF ONLY
            </p>
          </div>
        </div>
      </div>
    
      <!-- 這是分割線 -->
      <div class="w-75 horizontal-divider pt-4 mb-4"></div>
    
      <div class="col-10">
        <div class="row justify-content-center">
          <div class="col-4 col-md-2 col-lg-1 pb-4 px-1">
            <img src="imgs/img_no_pet.png" alt="No Pet" class="img-fluid">
          </div>
          <div class="col-4 col-md-2 col-lg-1 pb-4 px-1">
            <img src="imgs/img_no_guest.png" alt="No Guest" class="img-fluid">
          </div>
          <div class="col-4 col-md-2 col-lg-1 pb-4 px-1">
            <img src="imgs/img_no_standing.png" alt="No Staning" class="img-fluid">
          </div>
          <div class="col-4 col-md-2 col-lg-1 pb-4 px-1">
            <img src="imgs/img_no_smoking.png" alt="No Smoking" class="img-fluid">
          </div>
          <div class="col-4 col-md-2 col-lg-1 pb-4 px-1">
            <img src="imgs/img_no_food.png" alt="No Food" class="img-fluid">
          </div>
          <div class="col-4 col-md-2 col-lg-1 pb-4 px-1">
            <img src="imgs/img_no_durian.png" alt="No Durian" class="img-fluid">
          </div>
        </div>
      </div>
    </div>
  </div>

  <footer class="bg-footer">
    <div class="container py-4">
      <div class="row">
        <div class="col-12 text-center pb-5">
          <img src="imgs/img_shuttle_bee.png" alt="" class="img-bee">
          <p class="mb-0">Shuttle Bee is working hard to your destination…</p>
        </div>
        <div class="col-12 small text-center pb-5">
          Disclaimer: This web application is an <strong class="text-danger">unofficial</strong> shuttle bus schedule tracking tool and is for reference only.
        </div>
      </div>
    </div>
  </footer>

  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script> -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script src="js/routes.js"></script>

  <script>
    const greetingsConfig = {
      greetings: {
        MORNING: "Good Morning, Mate!",
        LUNCH: "Good Afternoon, Eater!",
        EVENING: "Good Evening, Off-Duty Hero!",
        BREAK: "Our Driver Need a Break!",
        GOODNIGHT: "Sorry! Off Service already!",
        WEEKEND: "Sorry! Off Service today!"
      },
      dailyMessages: {
        Monday: [
          "Monday? Let's make it a fun day!",
          "New week, new goals. Let's go!",
          "Monday blues? Nah, we got this!",
          "Wake up. Kick ass. Repeat. It's Monday!",
          "Hello, Monday. Be gentle, please."
        ],
        Tuesday: [
          "Keep the momentum, it's Tuesday!",
          "Tuesday: One step closer to Friday!",
          "You survived Monday. You got this!",
          "Tuesdays are for making progress!",
          "Stay strong, Tuesday won't last forever!"
        ],
        Wednesday: [
          "Halfway there! Happy Wednesday!",
          "It's Wednesday, keep pushing!",
          "The weekend is in sight!",
          "Work hard, Wednesday harder!",
          "Wednesdays are for warriors!"
        ],
        Thursday: [
          "Thursday vibes: Almost there!",
          "Push through, the weekend is calling!",
          "One more day to go, stay strong!",
          "Thirsty for Friday? Hold on!",
          "Thursday: The weekend's warm-up!"
        ],
        Friday: [
          "Finally Friday! Let's rock!",
          "It's Fri-YAY! Let the fun begin!",
          "Work hard, party harder. Happy Friday!",
          "Weekend mode: ON!",
          "Cheers to the weekend!"
        ]
      }
    };

    const serviceConfig = {
      manualOverride: {
        enabled: false,
        status: "SERVICE_UNKNOWN"
      },
      operatingHours: [
        {
          days: ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"],
          periods: [
            { start: "07:30", end: "10:00" },
            { start: "11:30", end: "14:00" },
            { start: "17:00", end: "19:30" }
          ]
        }
      ]
    };

    function updateGreeting() {
      const now = new Date();
      const hour = now.getHours();
      const currentDay = now.toLocaleDateString('en-US', { weekday: 'long' });
      const currentPeriod = getCurrentTimePeriod();

      let periodGreeting;
      if (currentDay === "Saturday" || currentDay === "Sunday") {
        periodGreeting = greetingsConfig.greetings.WEEKEND;
      } else if (hour >= 18 ) {
        periodGreeting = greetingsConfig.greetings.GOODNIGHT;
      } else if (currentPeriod === "none") {
        periodGreeting = greetingsConfig.greetings.BREAK;
      } else if (currentPeriod === "morning") {
        periodGreeting = greetingsConfig.greetings.MORNING;
      } else if (currentPeriod === "lunchMWF" || currentPeriod === "lunchTT") {
        periodGreeting = greetingsConfig.greetings.LUNCH;
      } else {
        periodGreeting = greetingsConfig.greetings.EVENING;
      }

      console.log(hour);

      const dailyMessages = greetingsConfig.dailyMessages[currentDay];
      const randomMessage = dailyMessages ? dailyMessages[Math.floor(Math.random() * dailyMessages.length)] : "";

      const greetingElement = document.querySelector('.greeting');
      const messageElement = document.querySelector('.message');
      const lookWhereElement = document.querySelector('.look-where');

      if (greetingElement) {
        greetingElement.textContent = periodGreeting;
      } else {
        console.error('Greeting element not found');
      }

      if (messageElement && lookWhereElement) {
        if (currentDay === "Saturday" || currentDay === "Sunday" || currentPeriod === "none") {
          messageElement.style.display = 'none';
          lookWhereElement.style.display = 'none';
        } else {
          messageElement.style.display = 'block';
          lookWhereElement.style.display = 'block';
          messageElement.textContent = randomMessage;
        }
      } else {
        console.error('Message or look-where element not found');
      }
    }
    updateGreeting();

    // 更新間隔改為每秒
    setInterval(updateGreeting, 60000); // 1分鐘

    // For testing manual override
    window.toggleManualOverride = function (enabled, status) {
      serviceConfig.manualOverride.enabled = enabled;
      if (status) serviceConfig.manualOverride.status = status;
    }

    console.log(`
  ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
  █▄▄ ▄▄█ ▄▄█ ▄▄▀█ ▄▀▄ ███▄▄ ▄▄█ ▄▄▀██▄██ ███ █ ▄▄▀█ ▄▄▀█
  ███ ███ ▄▄█ ▀▀ █ █▄█ █████ ███ ▀▀ ██ ▄█▄▀ ▀▄█ ▀▀ █ ██ █
  ███ ███▄▄▄█▄██▄█▄███▄█████ ███▄██▄█▄▄▄██▄█▄██▄██▄█▄██▄█
  ▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀
  `);
  </script>
</body>

</html>